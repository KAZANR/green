name: ci

on:
  push:
    branches:
      - main
  schedule:
    - cron: "0 9,18 * * *"

jobs:
  autogreen:
    runs-on: ubuntu-latest
    steps:
      - name: Clone repository
        uses: actions/checkout@v3

      - name: Auto green
        run: |
          git config --local user.email "xgz9713@gmail.com"
          git config --local user.name "KAZANR"
          git remote set-url origin https://${{ github.actor }}:${{ secrets.GITHUB_TOKEN }}@github.com/${{ github.repository }}
          git pull --rebase

          # å®šä¹‰è¡¨æƒ…ç¬¦å·åˆ—è¡¨
          emojis=("ğŸ˜€" "ğŸ˜ƒ" "ğŸ˜„" "ğŸ˜" "ğŸ˜†" "ğŸ˜…" "ğŸ¤£" "ğŸ˜‚" "ğŸ™‚" "ğŸ™ƒ" "ğŸ˜‰" "ğŸ˜Š" "ğŸ˜‡" "ğŸ¥°" "ğŸ˜" "ğŸ¤©" "ğŸ¥³" "ğŸ˜" "ğŸ¤“" "ğŸ§")
          # éšæœºé€‰æ‹© 3 ä¸ªè¡¨æƒ…
          num_emojis=3
          random_emojis=""
          for ((i = 0; i < num_emojis; i++)); do
            random_emoji=${emojis[$((RANDOM % ${#emojis[@]}))]}
            random_emojis="$random_emojis$random_emoji"
          done
          # æ„å»ºæäº¤ä¿¡æ¯
          commit_msg="Auto commit with emojis: $random_emojis to keep green squares."
          git commit --allow-empty -m "$commit_msg"
          git push
